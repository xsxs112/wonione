<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	  xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	  layout:decorate="layout/default">
	
	<th:block layout:fragment="customTitle">
		<title th:text="title"></title> 
	</th:block>
	<th:block layout:fragment="customContent">
	<style>
		table {
		  width:100%;
		}
		table, th{
		  border: 1px solid grey ;
		  border-collapse: collapse;
		  font-size: 17px;
		}
		th{
		  padding: 1px;
		  text-align: center;
		  background-color: lightgrey;
		}
		td {
		  padding: 3px;
		  border: 1px solid grey ;
		   text-align: center;
		  border-collapse: collapse;
		  font-size: 15px;
		
	</style>
			
	
		<form action="/workreportwrite" class="container-fluid" style="text-align:center">
			<div style="margin-bottom:10px">
			
				<button type="submit" class="btn btn-default btn-lg btn-block">보고서 작성하기</button><br>
			</div>
			<h3 style="color: grey;">개설예정 강의 계획보고서</h3><br>
		</form>	
		<form id="searchForm" class="form-inline" action="/searchList" method="post">  
			<select class="form-control" name="lecSk" id="lecSk">
			  <option value="lec_open_code">업무계획서코드</option>
			  <option value="lec_target">업무목표</option>
			  <option value="mr_name">작성자</option>
			</select> 
			
			<div class="form-group">
		  	 <input type="text" class="form-control" name="lecSv" placeholder="Search" id="lecSv"/>
			   <div class="input-group-btn pull-right">
			        <button class="btn btn-default form-group" type="button" id="searchBtn">검색</button>
			   </div>
		   </div>
		</form>
		<br>
			
		<table class ="table table-striped">
		<thead>
			<tr>
				<th>업무계획서코드</th>
				<th>개설예정 강의</th>
				<th>업무목표</th>
				<th>작성자</th>
				<th>작성일자</th>
				<th>상세보기</th>
			</tr>
		</thead>	
		<tbody>
			<tr th:each="r : ${reportList}">
			<td th:text=${r.lecOpenCode}></td>
			<td th:text=${r.lecOpenScheCode}></td>
			<td th:text=${r.lecTarget}></td>
			<td th:text=${r.mrName}></td>
			<td th:text=${r.openLecRegDate}></td>
			<td>
				<a th:href="@{/workreportpage(lecOpenCode=${r.lecOpenCode})}">상세보기</a>
			</td>	
			</tr>
		</tbody>	
		</table>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>	
	<script type="text/javascript"> 
	
	
	 $(function(){
			 $('#searchBtn').click(function(){
				 var lecSk = $('#lecSk').val();
				 var lecSv = $('#lecSv').val();
				 var searchForm = $('#searchForm');
				 console.log(lecSk + ' < -- lecSk');
				 console.log(lecSv + ' < -- lecSv');
				
					var request = $.ajax({
					  url: "/workreport",  
					  method: "GET", 
					  data: { lecSk : lecSk , lecSv : lecSv  }, 
					  dataType: "json"  
					});
					request.done(function(data) {   
					console.log(data);
					console.log(data.lecSk);
					console.log(data.lecSv);
					
					if(data == undefined || data == ''){
						alert('검색되는 내용이 없습니다.');
					}
					});
		
					request.fail(function( jqXHR, textStatus ) {
					  alert( "Request failed: " + textStatus );
					});
					searchForm.submit();
			 });
		 });
	
		</script>
	</th:block>
	<th:block layout:fragment="customJsScript">
	</th:block>
</html>